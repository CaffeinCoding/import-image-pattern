# Gemini 응답 결과

사용자가 선택한 셀의 **가로(너비)와 세로(높이) 크기를 픽셀 단위로** 가져오는 방법은 Google Apps Script의 `SpreadsheetApp` 서비스를 이용하는 것이며, 핵심은 `Sheet` 객체의 특정 메서드를 활용하는 것입니다.

아래는 선택한 셀의 픽셀 크기를 가져오는 상세한 절차와 예시 코드입니다.

---

## 📐 셀 크기 (픽셀) 가져오기 상세 방법

셀의 크기는 해당 셀이 속한 **열의 너비**와 **행의 높이**에 의해 결정됩니다.

### 1\. 선택된 범위 (Range) 확인

가장 먼저 현재 사용자가 스프레드시트에서 선택한 영역(`Range` 객체)을 식별해야 합니다.

| Apps Script 메서드                      | 설명                                                      |
| :-------------------------------------- | :-------------------------------------------------------- |
| `SpreadsheetApp.getActiveSpreadsheet()` | 현재 활성 스프레드시트 객체를 가져옵니다.                 |
| `ss.getActiveSheet()`                   | 활성 시트 객체를 가져옵니다.                              |
| `sheet.getActiveRange()`                | 사용자가 선택한 **활성 범위**를 가져옵니다.               |
| `range.getRow()`                        | 선택 범위의 **시작 행 인덱스** (1부터 시작)를 가져옵니다. |
| `range.getColumn()`                     | 선택 범위의 **시작 열 인덱스** (1부터 시작)를 가져옵니다. |

### 2\. 픽셀 크기 가져오기

선택된 셀이 속한 행과 열의 1부터 시작하는 인덱스를 알면, 다음과 같은 `Sheet` 메서드를 사용하여 픽셀 크기를 얻을 수 있습니다.

| Apps Script 메서드                     | 크기 정보                                                   |
| :------------------------------------- | :---------------------------------------------------------- |
| `sheet.getColumnWidth(columnPosition)` | 해당 열의 \*\*너비(가로 크기)\*\*를 픽셀 단위로 반환합니다. |
| `sheet.getRowHeight(rowPosition)`      | 해당 행의 \*\*높이(세로 크기)\*\*를 픽셀 단위로 반환합니다. |

---

## 💻 전체 예시 코드

다음 Apps Script 함수는 사용자가 선택한 범위 내의 **첫 번째 셀**의 픽셀 크기를 로그에 출력합니다.

```javascript
function getSelectedCellDimensionsInPixels() {
  try {
    // 1. 활성 스프레드시트와 시트 객체 가져오기
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const sheet = ss.getActiveSheet();

    // 2. 사용자가 선택한 활성 범위 가져오기
    const selectedRange = sheet.getActiveRange();

    if (!selectedRange) {
      Logger.log("오류: 선택된 셀이 없습니다.");
      SpreadsheetApp.getUi().alert("셀을 먼저 선택해 주세요.");
      return;
    }

    // 3. 선택된 범위의 시작 행과 열 인덱스 가져오기 (이것이 크기를 측정할 기준 셀이 됨)
    const row = selectedRange.getRow(); // 예: 5
    const column = selectedRange.getColumn(); // 예: 3 (C열)

    // 4. 셀의 크기 (픽셀 단위) 가져오기
    // 가로 크기 = 해당 열의 너비
    const widthInPixels = sheet.getColumnWidth(column);

    // 세로 크기 = 해당 행의 높이
    const heightInPixels = sheet.getRowHeight(row);

    // 5. 결과 로그 출력 및 사용자에게 알림 표시
    Logger.log(`선택된 셀 (Row: ${row}, Column: ${column})의 크기:`);
    Logger.log(`- 가로 너비: ${widthInPixels} 픽셀`);
    Logger.log(`- 세로 높이: ${heightInPixels} 픽셀`);

    SpreadsheetApp.getUi().alert(
      `선택된 셀의 크기 (픽셀)\n` +
        `너비: ${widthInPixels}px\n` +
        `높이: ${heightInPixels}px`
    );
  } catch (e) {
    Logger.log("스크립트 실행 중 오류 발생: " + e.toString());
  }
}
```

### 팁: 다중 셀 범위의 총 크기

사용자가 여러 셀을 선택한 경우(예: `A1:B2`), 위의 코드는 시작 셀(`A1`)의 크기만 반환합니다. 전체 선택 영역의 총 픽셀 크기를 계산하려면, 선택된 범위의 모든 행 높이와 모든 열 너비를 **반복문**을 사용하여 더해야 합니다.

```javascript
// A1:B2 범위의 총 너비 계산 예시
const startColumn = selectedRange.getColumn(); // A열 (1)
const numColumns = selectedRange.getNumColumns(); // 2개
let totalWidth = 0;

for (let i = 0; i < numColumns; i++) {
  // 1열 너비 + 2열 너비
  totalWidth += sheet.getColumnWidth(startColumn + i);
}
```
